# Инструкция к программе
### Библиотеки
- pandas 1.2.3  (для работы с датафреймом)
- joblib 1.0.1 (для открытия и сохранения модели)

Для обучения модели использовались следующие библиотеки:

- sklearn 0.24.1 (для обучения модели)
- pandas 1.2.3 (для работы с датафреймом)
- pymorphy2 0.9.1 (для очистки текста)
- regex (re) - 2021.4.4 (для очистки текста)
### Модель
База данных для модели является таблицей формата .xls со столбцами задание и тэг. Состоит из 509 строк. Столбец задания соответствует заданию (задания взяты из огэ по математике), а в столбце тэг записаны тэги к заданию. 
<br>Модель создана с помощью Pipeline с использованием KNeighborsClassifier и TfidfVectorizer.
<br>Модель сохранена с помощью библиотеки joblib в формате .pkl

### Классы и функции
- Классы
 - PredictionModel (содержит функции transform_json и predict, предназначен для предсказания)
- Функции  
 - init (аргументы - путь к модели)
 - transform_json (аргументы - исходные данные, которые преобразуются в функции. Возвращает измененный датафрейм с одним столбцом - theory)

 - predict (аргументы - исходные данные, которые преобразуются с помощью функции transform_json. Возвращает результат предсказания - словарь с 3 потенциальными тегами для каждого задания.

### Запуск программы
Чтобы запустить программу, необходимо создать экземпляр класса, подав на вход путь к модели:
<br>Пример: example = PredictionModel(model_path)

Путь к модели должен быть строкой.
<br>Пример: "model/model.pkl"

Далее, чтобы выполнить предсказание, необходимо вызвать функцию предсказания, подав в кач-ве аргумента входные данные:
<br>Пример: predict = example.predict(input_data)

В результате в переменной predict будет сохранен словарь с результатом предсказания для каждой задачи.
<br> Результатом предсказания является массив с 3 наиболее вероятными тегами для конкретной задачи.
### Файлы
program.py - файл с программой
model.pkl - обученная модель
requirements.txt - необходимые библиотеки
README.md - документация
### Комментарии
Предсказание основывается только на тексте задания, но с появлением базы данных можно будет использовать также название и другие параметры.
Предсказание может быть ошибочным, так как база данных небольшая.
Для теста рекомендуется вводить задания из ОГЭ по математике, тк модель обучена именно на них.






